\let\proof\relax
\let\endproof\relax
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{boxedminipage}
\usepackage{braket}
\usepackage{color}
\usepackage{comment}
\usepackage{enumitem}
\usepackage{joshuadunfield}
\usepackage{listings}
\usepackage{mathpartir}
\usepackage{mathtools}
\usepackage{semantic}
\usepackage{soul}
\usepackage[most]{tcolorbox}

\graphicspath{{./figures/}}

\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\Func}{\mc{F}}
\newcommand{\todo}[1]{\emph{\hl{TODO:} {#1}}}

\newcommand{\defeq}{\mathrel{\overset{\makebox[0pt]{\mbox{\normalfont\tiny\sffamily def}}}{=}}}

\newtcolorbox{func}[1][]{title={\textbf{Functionality}~$\Func_{\textsc{#1}}$},enhanced,
  coltitle=black,
  top=0.1in,
  attach boxed title to top left=
  {xshift=0.5cm,yshift=-\tcboxedtitleheight/2},
  boxed title style={size=small,colback=white},colback=white}

\definecolor{mygreen}{rgb}{0.0, 0.5, 0.0}

\lstdefinestyle{ilc}
{
    captionpos=b,
    basicstyle = {\sffamily},
    %commentstyle = {\itshape\color{orange}},
    %morecomment=[s]{/*}{*/},
    columns=fullflexible,
    literate = {|>}{{$\mid\triangleright\ $}}1 {->}{{$\rightarrow\ $}}1,
    mathescape=true,
    showstringspaces=false
}


% Marvosym
\let\MathRightArrow\Rightarrow % save original definition of \Rightarrow
\usepackage{marvosym} % feloniously overrides \Rightarrow
\def\Rightarrow{\MathRightArrow}

%% \declaretheorem[style=mytheoremstyle]{theorem}
%% \declaretheorem[style=mytheoremstyle]{property}
%% %\declaretheorem[style=mytheoremstyle, sibling=theorem]{lemma}
%% \declaretheorem[style=mytheoremstyle]{lemma}
%% \declaretheorem[style=mytheoremstyle, sibling=lemma]{corollary}
%% \declaretheorem[style=mytheoremstyle, sibling=lemma]{conjecture}
%% \declaretheorem{example}
%% \makeatletter
%% \declaretheorem[style=mytheoremstyle, sibling=lemma, 
%% %             postheadhook={%
%% %               envname is `\thmt@envname'; %
%% %               thmname is `\thmt@thmname'; %
%% %               optarg is `\thmt@optarg'; %
%% %%               innercounters are `\thmt@innercounters'.
%% %             }
%%        ]{proposition}
%% \makeatother
%% \declaretheorem{remark}
%% \declaretheorem[style=mytheoremstyle]{definition}


%% \theoremstyle{remark}

\newcommand{\Label}[1]{\label{#1}} % XXX
\newcommand{\FLabel}[1]{\label{#1}} % XXX
\newcommand{\D}{\mathcal{D}}
\newcommand{\Ss}{\mathcal{S}}
\newcommand{\derives}{::}
\newcommand{\satisfactory}{~\textsf{satisfactory}}
%\newcommand{\wf}{~\textsf{wf}}

%% \newtheorem{thm}{Theorem}[section]
%% \newtheorem*{thm*}{Theorem}
%% \newtheorem{lem}[thm]{Lemma}
%% \newtheorem{conj}[thm]{Conjecture}
%% \newtheorem{prop}[thm]{Proposition}
%% \newtheorem*{cor}{Corollary}
%% \newcommand{\thmref}[1]{Theorem~\ref{thm:#1}}
%% \newcommand{\thmreftwo}[2]{Theorems \ref{thm:#1} and~\ref{thm:#2}}
%% \newtheorem{defn}[thm]{Definition}

\newcommand{\vUnit}{\texttt{()}}
\newcommand{\Unit}{\tyname{unit}}
\newcommand{\Nat}{\tyname{nat}}

\newcommand{\runonboldsf}{\sffamily\bfseries\selectfont}
\newcommand{\boldsf}[1]{\text{\runonboldsf #1}}

% ILC Computation types
\newcommand{\xF}{\boldsf{F}}
\newcommand{\xU}{\boldsf{U}}
\newcommand{\tyFp}[1]{\xF(#1)}
\newcommand{\tyF}[1]{\xF\,#1}
\newcommand{\tyUp}[1]{\xU(#1)}
\newcommand{\tyU}[1]{\xU\,#1}

% ILC Read and Write channel types
\newcommand{\xRd}{\boldsf{Rd}}
\newcommand{\tyRdp}[1]{\xRd(#1)}
\newcommand{\tyRd}[1]{\xRd\,#1}

\newcommand{\xWr}{\boldsf{Wr}}
\newcommand{\tyWr}[1]{\xWr\,#1}
\newcommand{\tyWrp}[1]{\xWr(#1)}

% ILC Modes
\newcommand{\Rm}{\textsf{R}} % read mode
\newcommand{\Wm}{\textsf{W}} % write mode
\newcommand{\Vm}{\textsf{V}} % value mode

% Currently, using \All for both type variables (\All{\alpha : K}
% and index variables (\All{ea : \sort})
\newcommand{\Allsym}{\forall}
\newcommand{\All}[1]{\Allsym{#1}.\,}

\newcommand{\Split}[4]{\keyword{split}\Lparen{#1}, {#2}.{#3}.{#4}\Rparen}
\newcommand{\Case}[5]{\keyword{case}\Lparen{#1}, {#2}.{#3}, {#4}.{#5}\Rparen}

\newcommand{\inj}[1]{\keyword{inj}_{#1}\,}
\newcommand{\Inj}[1]{\inj{#1}}

\newcommand{\vPair}[2]{\Lparen{#1}\texttt{,}{#2}\Rparen}
\newcommand{\vInj}[2]{\keyword{inj}_{#1}\Lparen#2\Rparen}
\newcommand{\vThunk}[1]{\keyword{thunk}\Lparen#1\Rparen}

\newcommand{\eSplit}[4]{\keyword{split}\Lparen{#1}, {#2}.{#3}.{#4}\Rparen}
\newcommand{\eCase}[5]{\keyword{case}\Lparen{#1}, {#2}.{#3}, {#4}.{#5}\Rparen}

\newcommand{\eFork}[2]{\ensuremath{#1 *&& #2}}
\newcommand{\eChoose}[2]{\ensuremath{#1 *|| #2}}



\newcommand{\Sig}{\mathcal{S}}

\newcommand{\xFork}{\mathrel{|\rhd}}

%% Math ligatures (thanks to the semantic package) that make it
%% easier to typeset math using readable LaTeX text.
%\mathlig{|-->}{\longmapsto}
\mathlig{::=}{\bnfas}
\mathlig{|}{\;|\;}
% \mathlig{[[}{\mbsf{[}}
% \mathlig{]]}{\mbsf{]}}
\mathlig{[[}{\texttt{\upshape[}}
\mathlig{]]}{\texttt{\upshape]}}
\mathlig{**}{\times}
\mathlig{|>}{\rhd}
\mathlig{->}{\arr}
\mathlig{-->}{\rightarrow}
\mathlig{--->}{\longrightarrow}
\mathlig{=>}{\Rightarrow}
\mathlig{*!}{\boldsf{!}}
\mathlig{||}{\mathrel{|\!|}}
\mathlig{;;}{\mathrel{;}}
\mathlig{*&&}{\mathrel{\xFork}}
\mathlig{*||}{\mathrel{\oplus}}

\mathlig{@>}{\arr_{\namesort}}


\newcommand{\eff}[2]{{#1} |> {#2}}
\newcommand{\effseqsym}{\mathsf{then}}
\newcommand{\effseq}{\,\effseqsym\,}

\newcommand{\effcoalsym}{\mathsf{after}}
\newcommand{\effcoal}{\,\effcoalsym\,}

\newcommand{\Lparen}{\texttt{(}}
\newcommand{\Rparen}{\texttt{)}}
% \newcommand{\Pair}[2]{\Lparen{#1}\texttt{,}{#2}\Rparen}


%\mathlig{unit}{\unitty}


% Bidirectional typing

\newcommand{\chkcolor}{dBlue}
\newcommand{\syncolor}{dRed}
\newcommand{\isyncolor}{dGreen}
\newcommand{\chk}{\mathrel{\mathcolor{\chkcolor}{\Leftarrow}}}
\newcommand{\uncoloredsyn}{{\Rightarrow}}
\newcommand{\syn}{\mathrel{\mathcolor{\syncolor}{\uncoloredsyn}}}
\newcommand{\RRightarrow}{\mathrel{\mathrlap{\Rightarrow}\mkern2mu\Rightarrow}}
\newcommand{\isyn}{\mathrel{\mathcolor{\isyncolor}{\RRightarrow}}}
\mathlig{<<}{\langle}
\mathlig{>>}{\rangle}
\mathlig{==>}{\syn}
\mathlig{<==}{\chk}
%\mathlig{||}{\Downarrow}
\mathlig{!!}{\Downarrow}
% \mathlig{..}{\epsilon}

\newcommand{\e}{\epsilon}
\newcommand{\hist}{\mathcal{H}}

\newcommand{\ambns}{M}

\newcommand{\disjoint}{\mathrel{\bot}}

\newcommand{\tbrack}[1]{\texttt{\upshape[}{#1}\texttt{\upshape]}}

\newcommand{\rootname}{\textvtt{root}}

%\newcommand{\tv}{tv}
\newcommand{\Mv}{V}
\newcommand{\ntevalsym}{\Downarrow_{\mathsf{M}}}
\newcommand{\nteval}{\mathrel{\ntevalsym}}

\newcommand{\xrefv}{\keyword{ref}}
\newcommand{\xthunk}{\keyword{thunk}}
\newcommand{\xunthunk}{\keyword{unthunk}}
\newcommand{\xname}{\keyword{name}}
%\newcommand{\xName}{\tyname{Name}}
\newcommand{\xName}{\tyname{Nm}}

\newcommand{\xRef}{\tyname{Ref}}
%\newcommand{\xThunk}{\tyname{Thunk}}
\newcommand{\xThunk}{\tyname{Thk}}
\newcommand{\xUnthunk}{\tyname{Unthunk}}

\newcommand{\refv}[1]{\xrefv\;{#1}}
\newcommand{\thunk}[1]{\xthunk\;{#1}}
\newcommand{\unthunk}[1]{\xunthunk\;{#1}}
\newcommand{\name}[1]{\xname\;{#1}}
\newcommand{\Name}[1]{\xName\tbrack{#1}}


\newcommand{\Ref}[1]{\xRef\tbrack{#1}\,}
\newcommand{\Thk}[1]{\xThunk\tbrack{#1}\,}
\newcommand{\Unthk}[1]{\xUnthunk\tbrack{#1}\,}
\newcommand{\Thunk}[2]{\keyword{thunk}\Lparen{#1},{#2}\Rparen}
\newcommand{\Unthunk}[1]{\keyword{unthunk}\Lparen{#1}\Rparen}
\newcommand{\Refe}[2]{\keyword{ref}\Lparen{#1},{#2}\Rparen} % Ref expression form

\newcommand{\List}[3]{\tyname{List}\tbrack{#1;#2}~{#3}}
\newcommand{\Art}[2]{\tyname{Art}\tbrack{#1}~{#2}}
\newcommand{\Int}[0]{\tyname{Int}}

\let\Force\undefined
\newcommand{\eForce}[1]{\keyword{force}\Lparen{#1}\Rparen}

\newcommand{\App}[2]{#1\,#2}
\newcommand{\eApp}[2]{#1\,#2}

\newcommand{\Ret}[1]{\keyword{ret}\Lparen{#1}\Rparen}
\newcommand{\Let}[3]{\keyword{let}\Lparen{#1},{#2}.{#3}\Rparen}
\newcommand{\eLet}[3]{\keyword{let}\Lparen{#1},{#2}.{#3}\Rparen}
\newcommand{\LetBang}[3]{\keyword{let!}\Lparen{#1},{#2}.{#3}\Rparen}

% Channel read and Channel write expressions
\newcommand{\eRd}[1]{\keyword{rd}\Lparen#1\Rparen}
\newcommand{\eWr}[2]{\keyword{wr}\Lparen#1<-#2\Rparen}
\newcommand{\eNu}[2]{\nu#1.\,#2}

\newcommand{\xstoretype}{\textsf{has-store-type}}
\newcommand{\storetype}{\;\xstoretype\;}

\newcommand{\xterminal}{\textsf{terminal}}
\newcommand{\terminal}{\;\xterminal}

\newcommand{\Config}[2]{\left<#1;#2\right>}

\newcommand{\Chans}{\Sigma}
\newcommand{\vChan}[1]{\texttt{chan}\Lparen#1\Rparen}
\newcommand{\emptyChans}{\varepsilon}

\newcommand{\emptyctxt}{\cdot}

\newcommand{\Procs}{\pi}
\newcommand{\proc}{e}
\newcommand{\emptyProcs}{\varepsilon}

\newcommand{\bnfheader}[1]{\multicolumn{4}{@{}l}{\text{#1}}}
\newenvironment{sbnfarray}{\begin{tabular}{c}\begin{array}[t]{lr@{~~}c@{~~~}ll}}{\end{array}\end{tabular}}
\newenvironment{bnfarray}{\begin{tabular}{c}\begin{array}[t]{r@{~~}c@{~~~}ll}}{\end{array}\end{tabular}}
\newenvironment{xbnfarray}{\begin{tabular}{c}\begin{array}[t]{r@{~~}c@{~}l@{~~}l}}{\end{array}\end{tabular}}

\newcommand{\DHasEffects}[3]{#1~\textsf{reads}~#2~\textsf{writes}~#3}
\newcommand{\DByHasEffects}[4]{#1~\textsf{by}~#2~\textsf{reads}~#3~\textsf{writes}~#4}
\newcommand{\mergeRds}{\cup}
\newcommand{\joinWrs}{\mathrel{\ast}}
\newcommand{\joinGrs}{\mathrel{\ast}}
\newcommand{\mergeGrs}{\cup}
\newcommand{\restrict}[2]{\textsf{restrict}\lfloor{#1}\rfloor_{#2}}
\newcommand{\dom}[1]{\textsf{dom}(#1)}
\newcommand{\update}[4]{#1\{#2 \mapsto #3\} = #4}
%\newcommand{\disjoint}{\cupplus}

%\newcommand{\Dee}{\mathcal{D}}
%\newcommand{\D}{\mathcal{\Dee}}

\newcommand{\te}{e_{\mathsf{terminal}}}

\newcommand{\nfap}[3]{{\color{blue}{}^{#1}_{#2}}{\color{blue}\big[} #3 {\color{blue}\big]}}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: types
%%% End: 

\newcommand{\msf}[1]{\ensuremath{{\mathsf {#1}}}}
\newcommand{\mtt}[1]{\ensuremath{\mathtt {#1}}}
\newcommand{\mcal}[1]{\ensuremath{\mathcal {#1}}}
\newcommand{\val}{\msf{val}}
\newcommand{\sn}{\msf{sn}}

\newcommand{\tn}{\textnormal}
\newcommand{\codeb}[1]{\textsf{#1}}
\newcommand{\hash}{\ensuremath{{\mathcal H}}}
\newcommand{\adv}{\ensuremath{{\mathcal A}}\xspace}
\newcommand{\Adv}{\adv}
\newcommand{\A}{\adv}
\newcommand{\samples}{\overset{\$}{\leftarrow}}
\newcommand{\SA}{\msf{SA}}
% SaUCy specific
\newcommand{\SaUCy}{\xspace{\msf{SaUCy}}\xspace}
\newcommand{\leak}{\color{blue}\mtt{leak}}
\newcommand{\eventually}[1]{\color{blue}\mtt{leak}}
\newcommand{\poly}{\textnormal{poly}}
\newcommand{\negl}{\textnormal{negl}}
\newcommand{\execUC}[4]{\mtt{execUC}({#1},{#2},{#3},{#4})}
\newcommand{\chan}[1]{{\underline{\smash{\msf{#1}}}}}
\newcommand{\functionality}[1]{\ensuremath{{\mathcal F}_{\textnormal{\msf{{#1}}}}}}
\newcommand{\F}{\functionality}
%\newcommand{\G}[1]{{\mathcal G}_{\textnormal{\tiny {\uppercase{#1}}}}}
\newcommand{\GG}[1]{{\overline {\mathcal G}}_{\textnormal{\tiny {\uppercase{#1}}}}}
\renewcommand{\C}[1]{{\mathcal C}_{\textnormal{\tiny {\uppercase{#1}}}}}
\renewcommand{\P}{\ensuremath{\mathcal P}}
\newcommand{\Ps}{\ensuremath{\{\mathcal{P}_i\}_{i \in [N]}}}
\renewcommand{\S}{\ensuremath{\mathcal S}}
\newcommand{\env}{\Z}
\newcommand{\Z}{{\mcal{E}}}
\newcommand{\R}{{\mathcal R}}
