let (pid, sid) = rd x <- p2f . x in
  let d = rand in
    wr (pid, d) -> f2p .
    letrec loop = (let (pid, sid) = rd x <- p2f . x in
      wr (pid, d) -> f2p . loop) in loop
| wr (1, 0) -> p2f . let (pid, d) = rd x <- f2p . x in
    show pid ++ " received " ++ show d
| wr (1, 1) -> p2f . let (pid, d) = rd x <- f2p . x in
    show pid ++ " received " ++ show d
