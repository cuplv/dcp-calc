nu {p2f, f2p} .
let (pid, sid) = rd p2f in
  let d = rand in
    wr (pid, d) -> f2p .
    letrec loop = (let (pid, sid) = rd p2f in
      wr (pid, d) -> f2p . loop) in loop
| wr (0, 0) -> p2f . let (pid, d) = rd f2p in
    show pid ++ " received " ++ show d
| wr (1, 1) -> p2f . let (pid, d) = rd f2p in
    show pid ++ " received " ++ show d
