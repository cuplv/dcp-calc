(* We need to do two simultaneous writes,
   but this shouldn't type check *)
nu p2f, f2p .
  match rd p2f with ('Commit, sid, cid, P_i, P_j, b) in
    req mem b {0,1} in 
      wr (('Receipt, sid, cid, P_i, P_j), {P_j, S}) -> f2p .
        match rd p2f with ('Open, sid, cid, P_i, P_j) in
          wr (('Open, sid, cid, P_i, P_j, b), {P_j, S}) -> f2p
