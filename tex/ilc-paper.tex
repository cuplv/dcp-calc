\def\OPTIONConf{0}%
\def\OPTIONArxiv{0}%
%
\documentclass{llncs}
\input{defs}
\usepackage{joshuadunfield}
\usepackage{goodcharter} %% XXX -- Check that ETAPS permits this font!
\usepackage{euler}

\title{ILC: The Interactive Lambda Calculus}
\subtitle{$\lambda$-Calculus for Universal Composibility
  \\
  or, \emph{``Please, Halt Research with Interactive Turing Machines''}
}
\titlerunning{ILC}
\author{Andrew Miller\inst{1} \and Matthew A. Hammer\inst{2}}
\institute{University of Illinois \and University of Colorado Boulder}
\authorrunning{Miller and Hammer}

\begin{document}

\maketitle

\begin{abstract}

\end{abstract}

\section{Introduction}

\section{Overview}

\section{ILC: Abridged Language Definition}

\section{ILC: Meta Theory}

\begin{theorem}[Read determinism]
\label{thm:read-det}
XXX
\end{theorem}


\appendix
\section{ILC: Full Language Definition}


\paragraph{Done:}
\begin{enumerate}
\item Define syntax for $A, C, \Delta, \Gamma, v, e, m$
\item Define judgement $m_1 ;; m_2 => m_3$
\item Define judgement $m_1 || m_2 => m_3$
\item Define judgement $\Delta; \Gamma |- e : C |> m$
\end{enumerate}

\paragraph{To do:}
\begin{enumerate}
\item Define judgement $\Delta; \Gamma |- v : A$
\item Discuss typing for thunks
\item Define dynamic semantics judgement $e ---> e'$
\item State read determinism proof; prove it
\end{enumerate}


\begin{figure}[htbp]
  \centering

\begin{grammar}
  Value Types
  & $A,B$
      &$\bnfas$&
      $x$
      \\ &&& $\bnfaltbrk \unitexp$ & Unit value
      \\ &&& $\bnfaltbrk \natty$         & Natural number
      \\ &&& $\bnfaltbrk A ** B$ & Product
      \\ &&& $\bnfaltbrk A + B$ & Sum type
      \\ &&& $\bnfaltbrk *! A$ & Intuitionistic type
      \\ &&& $\bnfaltbrk \Rd A$ & Read channel
      \\ &&& $\bnfaltbrk \Wr A$ & Write channel
      \\ &&& $\bnfaltbrk \U C$ & Thunk type
  \\[1ex]
  Computation Types
  & $C, D$
      &$\bnfas$ & 
             $A -> C$ & Value-consuming computation
      \\ &&& $\bnfaltbrk \F A$ & Value-producing computation
  \\[1ex]
  Linear Typing Contexts
  & $\Delta$
     &$\bnfas$& $\emptyctxt \bnfalt \Delta,x:A$
  \\
  Intuitionisitic Typing Contexts
  & $\Gamma$
     &$\bnfas$& $\emptyctxt \bnfalt \Gamma,x:A$
\end{grammar}

  \caption{Syntax of types and typing contexts}
  \label{fig:expr}
\end{figure}


\begin{figure}[htbp]
  \centering

\begin{grammar}
  Values
  & $v$
      &$\bnfas$&
      $x$
      \\ &&& $\bnfaltbrk \unitexp$ & Unit value
      \\ &&& $\bnfaltbrk n$         & Natural number
      \\ &&& $\bnfaltbrk \Pair{v_1}{v_2}$ & Pair of values
      \\ &&& $\bnfaltbrk \inj{i}{v}$ & Injected value
      \\ &&& $\bnfaltbrk \thunk{n}$ & Thunk (suspended, closed expression)
  \\[1ex]
  Expressions
  & $e$
      &$\bnfas$&
             $\Split{v}{x_1}{x_2}{e}$ & Pair elimination
      \\ &&& $\bnfaltbrk \Case{v}{x_1}{e_1}{x_2}{e_2}$ & Injection elimination
      \\ &&& $\bnfaltbrk \Ret{v}$ & Value-producing computation
      \\ &&& $\bnfaltbrk \Let{e_1}{x}{e_2}$ & Let-binding/sequencing
      \\ &&& $\bnfaltbrk e\;v$ & Function application
      \\ &&& $\bnfaltbrk \lam{x} e$ & Function abstraction
      \\ &&& $\bnfaltbrk \Force{v}$ & Unsuspend (force) a thunk
      \\ &&& $\bnfaltbrk \wrexp{v_1}{v_2}$ & Channel write
      \\ &&& $\bnfaltbrk \rdexp{v}$ & Channel read
      \\ &&& $\bnfaltbrk \nuexp{x}{e}$ & Channel allocation
      \\ &&& $\bnfaltbrk e_1 || e_2$ & Parallel composition
      \\ &&& $\bnfaltbrk e_1 *& e_2$ & Parallel choice
\end{grammar}

  \caption{Syntax of values and expressions}
  \label{fig:expr}
\end{figure}


\begin{figure}[htbp]
{
  \centering

\begin{grammar}
  Modes & $m,n,p$ &$\bnfas$& $\Wm \bnfalt \Rm \bnfalt \Vm$ & (Write, Read and Value) 
\end{grammar}

\judgbox{m || n => p}{~~The parallel composition of modes $m$ and $n$ is mode~$p$.}
\begin{mathpar}
\Infer{sym}{m || n => p}{n || m => p}
\and \Infer{wv}{ }{\Wm || \Vm => \Wm}
\and \Infer{wr}{ }{\Wm || \Rm => \Wm}
\and \Infer{rr}{ }{\Rm || \Rm => \Rm}
\end{mathpar}
\\[2mm]
\judgbox{m ;; n => p}{~~The sequential composition of modes $m$ and $n$ is mode~$p$.}
\begin{mathpar}
\and \Infer{v$\ast$}{ }{\Vm ;; n => n}
\and \Infer{wv}{ }{\Wm ;; \Vm => \Wm}
\and \Infer{r$\ast$}{ }{\Rm ;; n => \Rm}
\and \Infer{wr}{ }{\Wm ;; \Rm => \Wm}
\end{mathpar}
}
Note that in particular, the following mode compositions are \emph{not derivable}:
\begin{itemize}
\item $\Wm || \Wm => p$ is \emph{not} derivable for any mode~$p$
\item $\Wm ;; \Wm => p$ is \emph{not} derivable for any mode~$p$
\end{itemize}
\caption{Syntax of modes; sequential and parallel mode composition.}
\label{fig:expr}
\end{figure}


\begin{figure}[htbp]
\centering
\judgbox{\Delta ; \Gamma |- e : C |> m}{~~Under $\Delta$ and $\Gamma$, expression~$e$ has type $C$ and mode $m$.}
\begin{mathpar}
%
\Infer{ret}
{\Delta ; \Gamma |- v : A}
{\Delta ; \Gamma |- \Ret{v} : \F A |> \Vm}
%
\and
%
\Infer{let}
{\Delta_1        ; \Gamma |- e_1 : \F A |> m_1 \\\\
 \Delta_2, x : A ; \Gamma |- e_2 : C |> m_2    \\\\
 m_1 ;; m_2 => m_3}
{\Delta_1, \Delta_2 ; \Gamma, x : A |- \Let{e_1}{x}{e_2} : C |> m_3}
%
\and
%
\Infer{ret!}
{\emptyctxt ; \Gamma |- v : A}
{\emptyctxt ; \Gamma |- \Ret{v} : \F (*! A) |> \Vm}
%
\and
%
\Infer{let!}
{\Delta_1 ; \Gamma |- v : *! A \\
 \Delta_2 ; \Gamma, x : A |- e : C |> m }
{\Delta_1, \Delta_2 ; \Gamma, x : A |- \LetBang{v}{x}{e} : C |> m}
%
\and
%
\Infer{lam}
{\Delta ; \Gamma |-         e :      C |> m}
{\Delta ; \Gamma |- \lam{x} e : A -> C |> m}
%
\and
%
\Infer{app}
{\Delta_1 ; \Gamma |- v : A \\
 \Delta_2 ; \Gamma |- e : A -> C |> m}
{\Delta_1, \Delta_2 ; \Gamma |- e\,v : C |> m}
%
\and
%
\Infer{nu}
{\Delta, x:\big(\Rd A ** *!(\Wr A)\big) ; \Gamma |- e : C |> m}
{\Delta                                 ; \Gamma |- \nuexp{x} : C |> m}
%
\\
%
\Infer{rd}
{\Delta; \Gamma |- v : \Rd A}
{\Delta         |- \rdexp{v} : \F (A ** (\Rd A)) |> \Rm}
%
\and
%
\Infer{wr}
{\Delta_1; \Gamma   |- v_1 : \Rd A \\
 \Delta_2; \Gamma   |- v_2 : A }
{\Delta_1, \Delta_2 |- \wrexp{v_1}{v_2} : \F \unitty |> \Wm}
%
\\
%
\Infer{par1}
{\Delta_1; \Gamma |- e_1 : C |> m_1\\\\
 \Delta_2; \Gamma |- e_2 : D |> m_2\\\\ %% XXX Does this second expression have type C, or some other type D ?
  m_1 || m_2 => m_3
}
{\Delta_1, \Delta_2 |- e_1 || e_2 : D |> m_3} 
%
\and
%
\Infer{par2}
{\Delta_1; \Gamma |- e_1 : C |> m_1\\\\
 \Delta_2; \Gamma |- e_2 : C |> m_2\\\\
  m_1 || m_2 => m_3
}
{\Delta_1, \Delta_2 |- e_1 *|| e_2 : C |> m_3}
%
\end{mathpar}
\end{figure}


\end{document}
